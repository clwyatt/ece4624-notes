<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chris Wyatt">
<meta name="dcterms.date" content="2025-09-03">

<title>ECE 4624: Meeting 3 – ECE 4624: DSP and Filter Design – Fall 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-226bd0f977fa82dfae4534cac220d79a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-55322a9a5c253ea6db55cdc93d44609f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">ECE 4624: DSP and Filter Design – Fall 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ECE 4624: Meeting 3</h1>
<p class="subtitle lead">CT Fourier Transform</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Chris Wyatt <a href="mailto:clwyatt@vt.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            ECE@Virginia Tech
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 3, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="section" class="level2 t">
<h2 class="t anchored" data-anchor-id="section"></h2>
<p>In the last lecture we defined a CT signal and saw how to build up models of such signals from mathematical primitives. Today we review how to do the opposite, decompose a given signal into primitives, namely complex exponentials (sinusoids). We also review how CT LTI systems affect signals via the frequency response and define a frequency selective filter we will use in the next lecture, the low-pass filter. Note: today’s lecture is a review of material from ECE 2714.</p>
<p>READINGS:</p>
<ul>
<li>PM 4.1.1 and 4.2</li>
<li>Chapter 14 ECE 2714 Supplementary Notes</li>
<li>Chapter 16 ECE 2714 Supplementary Notes</li>
<li>Chapter 18 ECE 2714 Supplementary Notes</li>
<li>Chapter 20 ECE 2714 Supplementary Notes</li>
</ul>
</section>
<section id="fourier-series-synthesis-and-analysis-equations" class="level2 t">
<h2 class="t anchored" data-anchor-id="fourier-series-synthesis-and-analysis-equations">Fourier Series: Synthesis and Analysis Equations</h2>
<p>Suppose we can approximate a periodic function <span class="math inline">\(x(t)\)</span> with period <span class="math inline">\(T_0\)</span> by the sum <span class="math display">\[x(t) \approx \sum\limits_{k = -\infty}^{\infty} a_k \, e^{j k\omega_0 t}\;.\]</span> This is called the <em>synthesis equation</em> of the CT Fourier series.</p>
<p>Note <span class="math inline">\(k\)</span> is an integer and the fundamental frequency <span class="math inline">\(\omega_0 = \frac{2\pi}{T_0}\)</span>.</p>
<p>The Fourier series coefficients, <span class="math inline">\(a_k\)</span>, are determined by the <em>analysis equation</em>: <span class="math display">\[a_k = \frac{1}{T_0} \int\limits_{0}^{T_0} x(t)e^{-jk\omega_0 t} \; dt\]</span> where the integration can be over any interval of length <span class="math inline">\(T_0\)</span> that is equal to the period.</p>
</section>
<section id="fourier-series-spectrum" class="level2 t">
<h2 class="t anchored" data-anchor-id="fourier-series-spectrum">Fourier Series: Spectrum</h2>
<p>The CT Fourier Series coefficients are also called the <em>spectrum</em> of the signal.</p>
<p>In general the <span class="math inline">\(a_k\)</span> are complex.</p>
<p>The function of <span class="math inline">\(k\)</span>, <span class="math inline">\(|a_k|\)</span> is called the <em>amplitude spectrum</em>.</p>
<p>The function of <span class="math inline">\(k\)</span>, <span class="math inline">\(\angle a_k\)</span> is called the <em>phase spectrum</em>.</p>
<p>When plotting the coefficients it is common to plot the amplitude and phase spectrum together.</p>
</section>
<section id="example-of-the-fourier-series" class="level2 t">
<h2 class="t anchored" data-anchor-id="example-of-the-fourier-series">Example of the Fourier series</h2>
<p>Consider the signal <span class="math display">\[x_p(t) = \left\{ \begin{array}{lc}
    t^2 &amp; -1 &lt; t &lt; 1\\
    0 &amp; \mbox{else}
  \end{array}
\right.\]</span> periodically extended with period <span class="math inline">\(T_0 = 2\)</span> <span class="math display">\[x(t) = \sum\limits_{i = -\infty}^{\infty} x_p(t - 2i)\]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/fig14_1.svg" class="img-fluid figure-img" alt="See the caption."></p>
<figcaption>Plot of the example signal.</figcaption>
</figure>
</div>
</section>
<section id="section-1" class="level2 t">
<h2 class="t anchored" data-anchor-id="section-1"></h2>
<p>To find the Fourier Series approximation of <span class="math inline">\(x(t)\)</span>, <span class="math display">\[x(t) \approx \sum\limits_{k = -\infty}^{\infty} a_k \, e^{j k\omega_0 t}\; ,\]</span> we need to find the coefficients <span class="math display">\[a_k = \frac{1}{T_0} \int\limits_{0}^{T_0} x(t)e^{-jk\omega_0 t} \; dt\]</span></p>
<p>Since the integration can be over any period, we can use the limits <span class="math inline">\([-1,1]\)</span> and note that <span class="math inline">\(T_0 = 2\)</span> so that <span class="math inline">\(\omega_0 = \pi\)</span>, <span class="math display">\[
  a_k = \frac{1}{2} \int\limits_{-1}^{1} t^2\,e^{-jk\pi t} \; dt
\]</span></p>
</section>
<section id="section-2" class="level2 t">
<h2 class="t anchored" data-anchor-id="section-2"></h2>
<p><span class="math display">\[\begin{align*}
  a_k &amp;= \frac{1}{2} \int\limits_{-1}^{1} t^2\,e^{-jk\pi t} \; dt\\
  &amp;= \frac{1}{2} \left[ \int\limits_{-1}^{1} t^2\,\cos(-k\pi t) \; dt + j \int\limits_{-1}^{1} t^2\,\sin(-k\pi t) \; dt \right]\\
  &amp;= \frac{1}{2} \left[ \int\limits_{-1}^{1} t^2\,\cos(k\pi t) \; dt + j \int\limits_{-1}^{1} - t^2\,\sin(k\pi t) \; dt \right]\\
  &amp;= \frac{1}{2} \frac{4k\pi\overbrace{\cos(k\pi)}^{(-1)^k} + 2(k^2\pi^2-2)\overbrace{\sin(k\pi)}^{\text{always = 0}}}{k^3\pi^3}\\
a_k &amp;= \frac{2}{k^2\pi^2}\left(-1\right)^k
\end{align*}\]</span></p>
</section>
<section id="section-3" class="level2 t">
<h2 class="t anchored" data-anchor-id="section-3"></h2>
<p><span class="math display">\[
a_k = \frac{2}{k^2\pi^2}\left(-1\right)^k
\]</span></p>
<p>This result is undefined for when <span class="math inline">\(k=0\)</span>. In that case note the original integral is <span class="math display">\[a_0 = \frac{1}{2} \int\limits_{-1}^{1} t^2 \; dt = \frac{1}{6}t^3 \Big|_{-1}^{1} = \frac{1}{3}\]</span> Thus the final approximation is <span class="math display">\[x(t) \approx \sum\limits_{k = -\infty}^{\infty} \underbrace{\frac{2}{k^2\pi^2}\left(-1\right)^k}_{a_k} \, e^{j k\pi t} \;.\]</span></p>
</section>
<section id="section-4" class="level2 t">
<h2 class="t anchored" data-anchor-id="section-4"></h2>
<p>The corresponding amplitude and phase spectrum plot:</p>
<div id="19a95003" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lecture-03-slides_files/figure-html/cell-2-output-1.png" alt="Two stacked stem plots: the top shows the amplitude spectrum of a(k), peaking at k = 0 with smaller symmetric values for other k; the bottom shows the phase spectrum, mostly zero except undefined points at k = 0." width="671" height="470" class="figure-img"></p>
<figcaption>Amplitude and phase spectrum plot for the example.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="convergence-of-the-ct-fourier-series" class="level2 t">
<h2 class="t anchored" data-anchor-id="convergence-of-the-ct-fourier-series">Convergence of the CT Fourier Series</h2>
<p>As mentioned above the Fourier Series is strictly speaking an approximation <span class="math display">\[x(t) \approx \sum\limits_{k = -\infty}^{\infty} a_k \, e^{j k\omega_0 t} \mbox{ where } a_k = \frac{1}{T_0} \int\limits_{T_0} x(t)e^{-jk\omega_0 t} \; dt\]</span> to determine when this approximation is an equivalence (and in what sense) we need to establish the existence and convergence of the integral and summation respectively.</p>
<p>The CTFS exists if the <em>Dirichlet Conditions</em> hold for the signal:</p>
<ul>
<li><p>The signal has a finite number of discontinuities per period.</p></li>
<li><p>The signal has a finite number of maxima and minima per period.</p></li>
<li><p>The signal is bounded, i.e.&nbsp;<span class="math display">\[\int_{T_0} |x(t)| \;dt &lt; \infty\]</span></p></li>
</ul>
</section>
<section id="ct-fourier-transform" class="level2 t">
<h2 class="t anchored" data-anchor-id="ct-fourier-transform">CT Fourier Transform</h2>
<p>Consider the aperiodic signal <span class="math display">\[x(t) = \begin{cases}
  p(t) &amp; A &lt; t &lt; B\\
  0 &amp; \text{else}
\end{cases}\]</span> and it’s periodic extension with fundamental frequency <span class="math inline">\(\omega_0 = \frac{2\pi}{T_0}\)</span> <span class="math display">\[x_p(t) = \sum\limits_{m = -\infty}^{\infty} x(t-mT_0)\]</span> where <span class="math inline">\(T_0 &gt; B-A\)</span>.</p>
<p>The CT Fourier series coefficients are <span class="math display">\[
  a_k = \frac{1}{T_0} \int\limits_{-\infty}^{\infty} x(t) e^{-jk\omega_0 t}\; dt
\]</span> since <span class="math inline">\(x(t) = 0\)</span> outside the interval <span class="math inline">\((A,B)\)</span>.</p>
</section>
<section id="section-5" class="level2 t">
<h2 class="t anchored" data-anchor-id="section-5"></h2>
<p>Define the <em>CT Fourier Transform</em> of <span class="math inline">\(x(t)\)</span> as <span class="math display">\[X(\omega) = \int\limits_{-\infty}^{\infty} x(t) e^{-j\omega t}\; dt\]</span> so that <span class="math display">\[a_k = \frac{1}{T_0} X(k\omega_0)\]</span> are samples of <span class="math inline">\(X(\omega)\)</span> spaced at frequencies <span class="math inline">\(\omega_0\)</span>.</p>
</section>
<section id="section-6" class="level2 t">
<h2 class="t anchored" data-anchor-id="section-6"></h2>
<p>By the CT Fourier series synthesis equation <span class="math display">\[x(t) = \sum\limits_{k = -\infty}^{\infty} \frac{1}{T_0} X(k\omega_0) e^{jk\omega_0 t}\]</span> Now, let <span class="math inline">\(T_0 \rightarrow \infty\)</span> so that the periodic copies move toward <span class="math inline">\(\infty\)</span> and <span class="math inline">\(x_p(t) \rightarrow x(t)\)</span>. At the same time the frequency sample spacing becomes infinitesimal and <span class="math display">\[X(k\omega_0) e^{jk\omega_0 t} \rightarrow X(\omega) e^{j\omega t}\; d\omega\]</span> To give the <em>Inverse Fourier Transform</em> <span class="math display">\[x(t) = \frac{1}{2\pi} \int\limits_{-\infty}^{\infty} X(\omega)e^{j\omega t}\; d\omega\]</span></p>
</section>
<section id="section-7" class="level2 t">
<h2 class="t anchored" data-anchor-id="section-7"></h2>
<p>This gives the <em>Fourier Transform Pair</em>: <span class="math display">\[\underbrace{X(\omega) = \mathcal{F}\{x(t)\} = \int\limits_{-\infty}^{\infty} x(t) e^{-j\omega t}\; dt}_{\text{Forward Transform / Analysis Equation}}
\hspace{3em}
\underbrace{x(t) = \mathcal{F}^{-1}\{X(\omega)\} = \frac{1}{2\pi} \int\limits_{-\infty}^{\infty} X(\omega)e^{j\omega t}\; d\omega}_{\text{Inverse
Transform / Synthesis Equation}}\]</span></p>
<p><strong>Note:</strong> The difference in notation between <span class="math inline">\(X(\omega)\)</span> and <span class="math inline">\(X(j\omega)\)</span> is superficial. They generally are the same function. For example <span class="math display">\[X(j\omega) = \frac{1}{1+(j\omega)^2} = \frac{1}{1-\omega^2} = X(\omega)\]</span> are the same function since <span class="math inline">\(j^2 = -1\)</span>.</p>
</section>
<section id="fourier-transform-pair" class="level2 t">
<h2 class="t anchored" data-anchor-id="fourier-transform-pair">Fourier Transform Pair</h2>
<p><span class="math display">\[\underbrace{X(\omega) = \mathcal{F}\{x(t)\} = \int\limits_{-\infty}^{\infty} x(t) e^{-j\omega t}\; dt}_{\text{Forward Transform / Analysis Equation}}
\hspace{3em}
\underbrace{x(t) = \mathcal{F}^{-1}\{X(\omega)\} = \frac{1}{2\pi} \int\limits_{-\infty}^{\infty} X(\omega)e^{j\omega t}\; d\omega}_{\text{Inverse Transform / Synthesis Equation}}\]</span></p>
<p>The forward transform decomposes <span class="math inline">\(x(t)\)</span> into an infinite number of complex sinusoids.</p>
<p>The inverse transform synthesizes a signal as an infinite sum of the sinusoids.</p>
<p>Note the signal <span class="math inline">\(x(t)\)</span> and <span class="math inline">\(X(\omega)\)</span> are the same signal, just represented in different <em>domains</em>, the time-domain and frequency-domain respectively.</p>
<p>Similar to the CT Fourier series, the function <span class="math inline">\(X(\omega)\)</span> is called the <em>spectrum</em> of the signal <span class="math inline">\(x(t)\)</span>. The magnitude spectrum is the function <span class="math inline">\(|X(\omega)|\)</span> and the phase spectrum is the function <span class="math inline">\(\angle X(\omega)\)</span>. It is common to plot the spectrum as the combination of the magnitude and phase spectrum.</p>
</section>
<section id="example-fourier-transform-of-the-impulse." class="level2 t">
<h2 class="t anchored" data-anchor-id="example-fourier-transform-of-the-impulse.">Example: Fourier Transform of the impulse.</h2>
<p>Consider the signal <span class="math inline">\(x(t) = \delta(t)\)</span>. The Fourier transform is <span class="math display">\[\begin{align*}
    X(\omega) &amp;= \int\limits_{-\infty}^{\infty} x(t) e^{-j\omega t}\; dt\\
    &amp;= \int\limits_{-\infty}^{\infty} \delta(t) e^{-j\omega t}\; dt\\
    &amp;= e^{-j\omega (0)} \mbox{ by the sifting property}\\
    &amp;= 1  
\end{align*}\]</span></p>
</section>
<section id="example-fourier-transform-of-the-causal-real-exponential." class="level2 t">
<h2 class="t anchored" data-anchor-id="example-fourier-transform-of-the-causal-real-exponential.">Example: Fourier transform of the causal real exponential.</h2>
<p>Consider the signal <span class="math inline">\(x(t) = e^{at}u(t)\)</span> for <span class="math inline">\(a\in \mathbb{R}\)</span>. The Fourier transform is <span class="math display">\[\begin{align*}
    X(\omega) &amp;= \int\limits_{-\infty}^{\infty} x(t) e^{-j\omega t}\; dt = \int\limits_{0}^{\infty}  e^{at} \, e^{-j\omega t}\; dt = \int\limits_{0}^{\infty}  e^{(a-j\omega) t}\; dt\\
    &amp;= \frac{1}{a-j\omega } e^{(a-j\omega) t} \Big|_{0}^{\infty} = \frac{1}{a-j\omega } \left[ \lim_{T\rightarrow\infty} e^{(a-j\omega) T} - \underbrace{e^{(a-j\omega) (0)}}_{1}\right]  
\end{align*}\]</span> This converges if <span class="math inline">\(a &lt; 0\)</span> and</p>
<p><span class="math display">\[X(\omega) = \frac{-1}{a-j\omega } = \frac{1}{j\omega-a} \mbox{ for } a &lt; 0\;.\]</span></p>
</section>
<section id="existence-of-the-ct-fourier-transform" class="level2 t">
<h2 class="t anchored" data-anchor-id="existence-of-the-ct-fourier-transform">Existence of the CT Fourier Transform</h2>
<p>The example of the real exponential above showed that for the Fourier transform to exist, the Fourier (analysis) integral must exist. Similar to the Fourier series some mild conditions, again called the Dirichlet conditions, are a sufficient prerequisite for the Fourier transform of a signal <span class="math inline">\(x(t)\)</span> to exist:</p>
<ul>
<li><p><span class="math inline">\(x(t)\)</span> is absolutely integrable <span class="math display">\[x(t) = \int\limits_{-\infty}^{\infty} |x(t)|\; dt &lt; \infty\]</span></p></li>
<li><p><span class="math inline">\(x(t)\)</span> has a finite number of minima and maxima over any finite interval</p></li>
<li><p><span class="math inline">\(x(t)\)</span> has a finite number of finite-valued discontinuities over any finite interval</p></li>
</ul>
<p>These conditions are not necessary however, and we can extend the Fourier transform to a broader class of signals, if we allow delta functions in the transform</p>
</section>
<section id="properties-of-ctft" class="level2 t">
<h2 class="t anchored" data-anchor-id="properties-of-ctft">Properties of CTFT</h2>
<ul>
<li><p><strong>Linearity:</strong> if <span class="math inline">\(x_1(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X_1(\omega)\)</span> and <span class="math inline">\(x_2(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X_2(\omega)\)</span> then <span class="math display">\[ax_1(t) + bx_2(t) \stackrel{\mathcal{F}}{\longleftrightarrow} aX_1(\omega) + bX_2(\omega)\]</span></p></li>
<li><p><strong>Convolution:</strong> if <span class="math inline">\(x_1(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X_1(\omega)\)</span> and <span class="math inline">\(x_2(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X_2(\omega)\)</span> then <span class="math display">\[x_1(t) * x_2(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X_1(\omega)X_2(\omega)\]</span> Note in particular if one signal is the system input and the other is the impulse response, the output is the product of the Fourier transforms of each, where the Fourier transform of <span class="math inline">\(h(t)\)</span> is <span class="math inline">\(H(\omega)\)</span>, the frequency response.</p></li>
<li><p><strong>Differentiation:</strong> if <span class="math inline">\(x(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X(\omega)\)</span> then <span class="math display">\[\frac{dx}{dt}(t) \stackrel{\mathcal{F}}{\longleftrightarrow} j\omega X(\omega)\]</span> This allows us to easily determine the frequency response from a stable differential equation.</p></li>
</ul>
</section>
<section id="properties-of-ctft-1" class="level2 t">
<h2 class="t anchored" data-anchor-id="properties-of-ctft-1">Properties of CTFT</h2>
<ul>
<li><p><strong>Multiplication:</strong> if <span class="math inline">\(x_1(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X_1(\omega)\)</span> and <span class="math inline">\(x_2(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X_2(\omega)\)</span> then <span class="math display">\[x_1(t) \cdot x_2(t) \stackrel{\mathcal{F}}{\longleftrightarrow} \frac{1}{2\pi} X_1(\omega)*X_2(\omega)\]</span> where <span class="math inline">\(X_1(\omega)*X_2(\omega)\)</span> is convolution in the frequency domain <span class="math display">\[X_1(\omega)*X_2(\omega) = \int\limits_{-\infty}^{\infty} X_1(\gamma)\cdot X_2(\omega-\gamma)\;d\gamma\]</span></p></li>
<li><p><strong>Time-Shift:</strong> if <span class="math inline">\(x(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X(\omega)\)</span> then <span class="math display">\[x(t-t_0) \stackrel{\mathcal{F}}{\longleftrightarrow} X(\omega)e^{-j\omega t_0}\]</span></p></li>
<li><p><strong>Frequency-Shift:</strong> if <span class="math inline">\(x(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X(\omega)\)</span> then <span class="math display">\[e^{j\omega_0 t}x(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X(\omega-\omega_o)\]</span></p></li>
</ul>
</section>
<section id="properties-of-ctft-2" class="level2 t">
<h2 class="t anchored" data-anchor-id="properties-of-ctft-2">Properties of CTFT</h2>
<ul>
<li><p><strong>Conjugate Symmetry:</strong> if <span class="math inline">\(x(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X(\omega)\)</span> then <span class="math display">\[x^*(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X^*(-\omega)\]</span> This implies that if <span class="math inline">\(x(t)\)</span> is real, then the magnitude spectrum is an even function, and the phase spectrum is an odd function.</p></li>
<li><p><strong>Integration:</strong> if <span class="math inline">\(x(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X(\omega)\)</span> then <span class="math display">\[\int\limits_{-\infty}^t x(\tau)\; d\tau \stackrel{\mathcal{F}}{\longleftrightarrow} \frac{1}{j\omega} X(\omega) + \pi X(0) \delta(\omega)\]</span></p></li>
<li><p><strong>Time and Frequency Scaling:</strong> if <span class="math inline">\(x(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X(\omega)\)</span> then if <span class="math inline">\(a\)</span> is a real constant <span class="math display">\[x(at) \stackrel{\mathcal{F}}{\longleftrightarrow} \frac{1}{|a|} X\left(\frac{\omega}{a}\right)\]</span></p></li>
</ul>
</section>
<section id="properties-of-ctft-3" class="level2 t">
<h2 class="t anchored" data-anchor-id="properties-of-ctft-3">Properties of CTFT</h2>
<ul>
<li><strong>Parseval’s Relation:</strong> if <span class="math inline">\(x(t) \stackrel{\mathcal{F}}{\longleftrightarrow} X(\omega)\)</span> then <span class="math display">\[\int\limits_{0-\infty}^{\infty} |x(t)|^2\; dt =  \frac{1}{2\pi}\int\limits_{0-\infty}^{\infty} |X(\omega)|^2\;d\omega\]</span></li>
</ul>
<p>The plot of <span class="math inline">\(|X(\omega)|^2\)</span> as a function of frequency is called the <em>power spectrum</em> of the signal.</p>
</section>
<section id="frequency-response-of-ct-lti-systems" class="level2 t">
<h2 class="t anchored" data-anchor-id="frequency-response-of-ct-lti-systems">Frequency Response of CT LTI Systems</h2>
<p>The input-output relationship for a stable LTI system is <span class="math display">\[x(t) = \frac{1}{2\pi}\int\limits_{-\infty}^{\infty} X(j\omega) \, e^{j \omega t}\; d\omega \;\longrightarrow\; y(t) = \frac{1}{2\pi}\int\limits_{-\infty}^{\infty} H(j\omega) X(j\omega) \, e^{j \omega t}\; d\omega\]</span> where <span class="math inline">\(H(j \omega)\)</span> are the Eigenvalues, called the <em>frequency response</em>.</p>
<p>The frequency response of a CT LTI system can be thought of as arising in several equivalent ways.</p>
<ul>
<li>Using the Eigenvalues / Transfer Function</li>
<li>Using the CTFT of the impulse responsr <span class="math inline">\(h(t)\)</span></li>
<li>Directly from a linear, constant-coefficient differential equation</li>
</ul>
</section>
<section id="section-8" class="level2 t">
<h2 class="t anchored" data-anchor-id="section-8"></h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/fig4_1.svg" class="img-fluid figure-img" alt="See the caption."></p>
<figcaption>Schematic depiction of analysis of continuous-time systems using Fourier techniques.</figcaption>
</figure>
</div>
</section>
<section id="magnitude-phase-representation-of-the-ctfr" class="level2 t">
<h2 class="t anchored" data-anchor-id="magnitude-phase-representation-of-the-ctfr">Magnitude-phase representation of the CTFR</h2>
<p>Note that any complex valued function can be expressed in polar form using the magnitude and phase. Specifically the input and output can be put into this form <span class="math display">\[X(j\omega) = |X(j\omega)|e^{\angle X(j\omega)}\]</span> <span class="math display">\[Y(j\omega) = |Y(j\omega)|e^{\angle Y(j\omega)}\]</span></p>
<p>By the convolution theorem then <span class="math display">\[H(j\omega) = \frac{Y(j\omega)}{X(j\omega)} = \frac{|Y(j\omega)|e^{\angle Y(j\omega)}}{|X(j\omega)|e^{\angle X(j\omega)}} = \frac{|Y(j\omega)|}{|X(j\omega)|}e^{\angle Y(j\omega) - \angle X(j\omega)} = |H(j\omega)|e^{\angle H(j\omega)}\]</span> This gives the magnitude and phase representation of the frequency response</p>
<p><span class="math display">\[
|H(j\omega)| = \frac{|Y(j\omega)|}{|X(j\omega)|}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\angle H(j\omega) = \angle Y(j\omega) - \angle X(j\omega)
\]</span></p>
</section>
<section id="ctfr-acting-on-sinusoids" class="level2 t">
<h2 class="t anchored" data-anchor-id="ctfr-acting-on-sinusoids">CTFR acting on sinusoids</h2>
<p>The advantage of the magnitude and phase representation of the frequency response, is the ease with which we can find the output due to a sinusoidal input. If we apply a sinusoidal input <span class="math inline">\(x(t) = A e^{j\omega t}\)</span>, the output is a the same sinusoid scaled by the frequency response <span class="math inline">\(y(t) = H(j\omega) A e^{j\omega t}\)</span>.</p>
<p>Now using the magnitude and phase representation <span class="math display">\[y(t) = H(j\omega) A e^{j\omega t} = |H(j\omega)|e^{\angle H(j\omega)} A e^{j\omega t} = A |H(j\omega)| e^{j\omega t + \angle H(j\omega)}\]</span> Thus we can interpret the frequency response as telling us how the input sinsusoids are scaled in magnitude and phase shifted as they pass through the system.</p>
<p>By the linearity property this extends to real sinusoidal inputs <span class="math display">\[
  \cos(\omega t + \theta) \longrightarrow |H(j\omega)|\cos(\omega t + \theta + \angle H(j\omega))  
\]</span></p>
</section>
<section id="section-9" class="level2 t">
<h2 class="t anchored" data-anchor-id="section-9"></h2>
<p>Also by the linearity property this analysis extends to the CT Fourier representation of a signal (an infinite sum of sinusoids): <span class="math display">\[x(t) = \frac{1}{2\pi}\int\limits_{-\infty}^{\infty} X(j \omega) \, e^{j \omega t}\; d\omega \;\longrightarrow\; y(t) = \frac{1}{2\pi}\int\limits_{-\infty}^{\infty} \left| H(j \omega)\right| X(j \omega) \, e^{j \omega t + \angle H(j \omega)}\; d\omega\]</span></p>
<p>Thus we arrive at the reason for the name <em>Frequency Response</em> – it specifies the the response of a stable system to any linear combination of sinusoidal inputs, i.e.&nbsp;any signal with a Fourier Transform.</p>
</section>
<section id="bode-plots" class="level2 t">
<h2 class="t anchored" data-anchor-id="bode-plots">Bode plots</h2>
<p>We can visualize the frequency response as a plot of the real and imaginary part, or, of the magnitude and phase. Since the magnitude and phase allow us to directly see the system behavior at a given frequency, those plots are much more useful.</p>
<p>Rather than simply plot the magnitude and phase as a function of <span class="math inline">\(\omega\)</span>, it is common to change the abscissa (horizontal / <span class="math inline">\(\omega\)</span>-axis) to be on a logarithmic scale and so only plot the positive frequency portion of the spectrum.</p>
<p>Plotting on a log-scale compresses this information horizontally so that we can see how a wide range of frequency content is scaled. When plotting the magnitude spectrum it is also common to make the ordinate (vertical / gain axis) to be in decibels (dB).</p>
<p>Thus the magnitude of the frequency response in dB is <span class="math inline">\(20 \log_{10} |H(j\omega)|\)</span>. When the frequency response is plotted this particular way we get what is called a <em>Bode plot</em>.</p>
</section>
<section id="example" class="level2 t">
<h2 class="t anchored" data-anchor-id="example">Example</h2>
<p><span class="math display">\[H(j\omega) = \frac{20000}{(j\omega)^2 + 300(j\omega) + 20000}\]</span></p>
<div id="0e62363e" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="lecture-03-slides_files/figure-html/cell-3-output-1.png" width="662" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="filters-in-ct" class="level2 t">
<h2 class="t anchored" data-anchor-id="filters-in-ct">Filters in CT</h2>
<p>Given a stable LTI system with frequency response <span class="math inline">\(H(j\omega)\)</span> <span class="math display">\[x(t) = \frac{1}{2\pi} \int\limits_{-\infty}^{\infty} X(j\omega) e^{j\omega t}\; d\omega \longrightarrow y(t) = \frac{1}{2\pi} \int\limits_{-\infty}^{\infty} X(j\omega) H(j\omega) e^{j\omega t}\; d\omega\]</span></p>
<p>Note the output is equivalent to a signal with Fourier Transform <span class="math inline">\(Y(j\omega) = X(j\omega) H(jk\omega_0)\)</span>. That is the Fourier transform at each continuous frequency <span class="math inline">\(\omega\)</span> is scaled by the frequency response at that frequency.</p>
<p>We can use this behavior to our advantage. In many applications we want to modify the values of <span class="math inline">\(a_k\)</span> or <span class="math inline">\(X(j\omega)\)</span> selectively, passing them unmodified, increasing (amplifying) them, or decreasing (attenuating) them. This is accomplished by designing a frequency response. Such systems are called frequency selective <em>filters</em> and come in 4 basic types.</p>
<p>We will be discussing filters in much more detail later. For now we just need to define one of the types, the <em>lowpass filter</em>.</p>
</section>
<section id="lowpass-ct-filters" class="level2 t">
<h2 class="t anchored" data-anchor-id="lowpass-ct-filters">Lowpass CT Filters</h2>
<p>Low-pass Filters attenuate high frequencies while passing through lower frequencies. They are often used to reduce the effects of high-frequency noise in a signal and to prepare it for sampling (anti-aliasing filters). They are the most common filter.</p>
<p>Low-pass filters remove frequency content above a threshold, <span class="math inline">\(\omega_c\)</span>, called the <em>cutoff frequency</em>. They have an ideal (although unrealizable) frequency response <span class="math display">\[H(j\omega) = \left\{ \begin{array}{lc}
  1 &amp; -\omega_c &lt; \omega &lt; \omega_c\\
  0 &amp; \text{else}
\end{array}
\right.\]</span></p>
<p>The range of frequencies below <span class="math inline">\(|\omega_c|\)</span> are called the pass-band. The range of frequencies above <span class="math inline">\(|\omega_c|\)</span> are called the stop-band.</p>
</section>
<section id="practical-lowpass-filters" class="level2 t">
<h2 class="t anchored" data-anchor-id="practical-lowpass-filters">Practical Lowpass Filters</h2>
<p>Ideal CT filters cannot be implemented in practice because they are non-causal and thus physically impossible.</p>
<p>Practical filters are described by a frequency response that is a ratio of two polynomials in <span class="math inline">\(j\omega\)</span>, i.e. <span class="math display">\[H(j\omega) = \frac{K \cdot(j\omega - \beta_1)\cdot(j\omega - \beta_2)\cdots (j\omega - \beta_M)}{(j\omega - \alpha_1)\cdot(j\omega - \alpha_2)\cdots (j\omega - \alpha_N)}\]</span> where <span class="math inline">\(K\)</span> is a constant that controls the gain at DC, and the zero or more complex coefficients <span class="math inline">\(\beta_k\)</span> and the one or more complex coefficients <span class="math inline">\(\alpha_k\)</span> are called the <em>zeros</em> and <em>poles</em> of the filter respectively.</p>
<p>Practical filters differ from ideal filters in that they cannot be zero over any finite range of frequencies and cannot transition discontinuously between stop and pass bands. Instead they must vary over the bands and transition smoothly, with a degree of variation and sharpness that is a function of the order of the filter and the exact form of the frequency response polynomials. Thus practical filters are described by additional parameters that define the stop and pass-bands.</p>
</section>
<section id="lowpass-filter-specification" class="level2 t">
<h2 class="t anchored" data-anchor-id="lowpass-filter-specification">Lowpass Filter Specification</h2>
<p>The overall <em>gain</em> of the filter is the magnitude of the frequency response at a frequency that depends on the filter type, zero for a low-pass filter.</p>
<p>The <em>pass-band</em> is defined by the frequency at which the magnitude of the frequency response drops below the overall gain, often -3dB = <span class="math inline">\(\frac{\sqrt{2}}{2}\)</span>.</p>
<p>The <em>stop-band</em> is defined similarly, as the frequency at which the magnitude of the frequency response drops further below the overall gain, often -20dB = 0.1 or -40dB = 0.01.</p>
<p>The <em>transition bandwidth</em> is defined as the difference in the stop-band and pass-band frequencies.</p>
<p>The <em>pass-band ripple</em> is defined as the maximum deviation from the overall gain, over the pass-band.</p>
</section>
<section id="lowpass-filter-specification-1" class="level2 t">
<h2 class="t anchored" data-anchor-id="lowpass-filter-specification-1">Lowpass Filter Specification</h2>
<div id="f023c495" class="cell" data-execution_count="3">
<div class="cell-output cell-output-stderr">
<pre><code>/home/clwyatt/.local/lib/python3.10/site-packages/scipy/signal/_ltisys.py:599: BadCoefficients: Badly conditioned filter coefficients (numerator): the results may be meaningless
  self.num, self.den = normalize(*system)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="lecture-03-slides_files/figure-html/cell-4-output-2.png" width="662" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/clwyatt\.github\.io\/ece4624-notes\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>